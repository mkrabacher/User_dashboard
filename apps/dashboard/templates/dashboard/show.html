<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>{{user.fName}}'s Dashboard</title>
</head>
<body>
    <div id="navbar">
        <h3 class="nav-obj">Social Dashboard</h3>||
        <a href="/" class="nav-btn">Home</a>||
        {%if request.session.curr_user_id == 'none'%}
        <a href="/register/" class="nav-btn">Register</a>||
        <a href="/signin/" class="nav-btn">Sign In</a>||
        {%else%}
        <h4 class="nav-obj">Welcome {{curr_user.fName}} {{curr_user.lName}}</h4>||
        <a href="/dashboard/all" class="nav-btn">Find Users</a>||
        <a href="/users/{{curr_user.id}}/edit" class="nav-btn">Profile</a>||
        <a href="/dashboard/show/{{curr_user.id}}" class="nav-btn">My Dashboard</a>||
        <a href="/logout" class="nav-btn">Sign Out</a>||
        {%endif%}
    </div>
    <hr>

    <h1>{{user.fName}} {{user.lName}}</h1>
    <div>
        <p>Regerstered at: {{user.created_at}}</p>
        <p>ID #: {{user.id}}</p>
        <p>Email: {{user.email}}</p>
        <p>Birthdate: {{user.birthday}}</p>
        <p>About Me: {{user.desc}}</p>
    </div>
        <!-- Everything below is untested -->
    <div>
        {%if user.id == request.session.curr_user_id%}
        <h1>Your Dashboard</h1>
        {%else%}
        <h1>{{user.fName}}'s Dashboard</h1>
        {%endif%}
        <div class="post">
            <form action="/dashboard/createPost/" method="post">
                {%csrf_token%}
                <textarea name="post" cols="70" rows="4" placeholder="write a message to {{user.fName}}..."></textarea><br>
                <input type="hidden" name="receiver_id" value="{{user.id}}">
                <input type="hidden" name="poster_id" value="{{curr_user.id}}">
                <input type="submit" value="Post message">
            </form>
        </div>
        
        {%for post in user.posts_received.all%}
        <div class="post">
            <p><strong><a href="/dashboard/show/{{post.post_maker.id}}" class="nav-btn">{{post.post_maker.fName}} {{post.post_maker.lName}}</a> - {{post.updated_at}}</strong></p>
            <p>{{post.content}}</p>
        </div>
            {%for comment in post.comments.all%}
            <div class="comment">
                <p><strong><a href="/dashboard/show/{{comment.comment_maker.id}}" class="nav-btn">--{{comment.comment_maker.fName}} {{comment.comment_maker.lName}}</a> - {{comment.updated_at}}</strong></p>
                <p>--{{comment.content}}</p>
            </div>
            {%endfor%}
        
        <div class="comment">
            <form action="/dashboard/createComment/" method="post">
                {%csrf_token%}
                <textarea name="comment" cols="50" rows="4" placeholder="comment on this..."></textarea><br>
                <input type="hidden" name="post_id" value="{{post.id}}">
                <input type="hidden" name="commenter_id" value="{{curr_user.id}}">
                <input type="submit" value="Comment">
            </form>
        </div>
        {%endfor%}
    </div>

</body>
</html>